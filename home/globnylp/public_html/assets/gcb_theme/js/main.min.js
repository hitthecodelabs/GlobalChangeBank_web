document.addEventListener("DOMContentLoaded",()=>{const 
e=document.getElementById("offCanvasArea"),
t=document.querySelector(".toggle-off-canvas"),
s=document.querySelector(".l-off-canvas-overlay"),
o=document.body;

function n(){e&&e.classList.remove("is-open"),
s&&s.classList.remove("is-active"),
o.classList.remove("off-canvas-open"),
t&&t.setAttribute("aria-expanded","false")}

function a(){e&&e.classList.add("is-open"),
s&&s.classList.add("is-active"),
o.classList.add("off-canvas-open"),
t&&t.setAttribute("aria-expanded","true")}

t&&t.addEventListener("click",(()=>{e&&e.classList.contains("is-open")?n():a()})),
s&&s.addEventListener("click",n),
document.addEventListener("keyup",e=>{"Escape"===e.key&&n()});

const c=document.querySelectorAll(".quick-links__image"),
l=document.querySelectorAll(".quick-links__item");

function i(e){c.length&&(c.forEach(e=>e.classList.remove("active")),
c[e%c.length].classList.add("active"))}l.forEach(((e,t)=>{e.addEventListener("mouseenter",(()=>i(t))),

e.addEventListener("focus",(()=>i(t))),
e.addEventListener("mouseleave",(()=>i(0))),
e.addEventListener("blur",(()=>i(0)))}));

const r=document.querySelectorAll(".promo-card a.arrow-link");

r.forEach((e=>{e.addEventListener("focus",(()=>{e.parentElement&&e.parentElement.classList.add("is-focused")})),
e.addEventListener("blur",(()=>{e.parentElement&&e.parentElement.classList.remove("is-focused")}))}))});

/* === Mobile off-canvas toggle === */
(function(){
  const btn = document.querySelector('.toggle-off-canvas');
  const panel = document.getElementById('offCanvasArea');
  // Usa la overlay existente; si no existe, la crea.
  let overlay = document.querySelector('.offcanvas-overlay');
  if(!overlay){
    overlay = document.createElement('div');
    overlay.className = 'offcanvas-overlay';
    document.body.appendChild(overlay);
  }
  if(!btn || !panel) return;

  const open = () => {
    panel.classList.add('is-open');
    overlay.classList.add('is-active');
    btn.setAttribute('aria-expanded','true');
    document.body.classList.add('no-scroll');
  };
  const close = () => {
    panel.classList.remove('is-open');
    overlay.classList.remove('is-active');
    btn.setAttribute('aria-expanded','false');
    document.body.classList.remove('no-scroll');
  };

  btn.addEventListener('click', () => (panel.classList.contains('is-open') ? close() : open()));
  overlay.addEventListener('click', close);
  document.addEventListener('keydown', e => { if(e.key === 'Escape') close(); });
})();


